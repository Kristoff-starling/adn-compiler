app_name: "hotel_reservation"

app_structure:
    - "FrontEnd->Search"
    - "FrontEnd->Reservation"
    - "FrontEnd->Recommendation"
    - "FrontEnd->User"
    - "Search->Profile"
    - "Search->Geo"
    - "Search->Rate"

ingress:
    Recommendation:
    -
        name: "Metrics"
        spec: "examples/match_action/metrics.adn"
        config:
            type: "count"
            field: "status"
        position: "S"

egress:
    FrontEnd:
    -
        name: "RateLimit"
        spec: "examples/match_action/ratelimit_drop.adn"
        config:
            bucket_size: 10
            fill_interval: 60
        position: "C"
    -
        name: "LoadBalancing"
        spec: "examples/match_action/load_balance_sticky.adn"
        config:
            strategy: "sticky"
        position: "C"
edge:
    FrontEnd->Recommendation:
    -
        name: "RetryTimeout"
        spec: "examples/match_action/retry_timeout.adn"
        config:
            timeout: 10
            retry: 3
        position: "C"
    -
        name: "AdmissionControl"
        spec: "examples/match_action/admission_control.adn"
        config:
            strategy: "SuccessRate"
link:
    FrontEnd->Recommendation:
    -
        name1: "Compressor"
        name2: "Decompressor"
        spec: "examples/match_action/compressor_decompressor.adn"
        config:
            library: "gzip"
